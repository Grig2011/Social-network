@model List<DevNet.Models.Post>

@{
    Layout = "_Layout";
    ViewData["Title"] = "Posts";
}

<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
<link rel="stylesheet" href="~/css/Post.css" />

<div class="posts-container">

    @if (Model != null && Model.Any())
    {
        foreach (var post in Model)
        {
            <div class="post">
                <div class="post-header">

                    <div class="menu">
                        <!-- Vertical dots -->
                        <i class="bi bi-three-dots-vertical menu-icon" onclick="toggleMenu(this)"></i>

                        <!-- Dropdown -->
                        <div class="menu-content">
                            <a asp-action="Edit"
                               asp-controller="Post"
                               asp-route-id="@post.Id"
                               class="edit-link">
                                <i class="bi bi-pencil"></i> Edit
                            </a>

                            <form asp-action="Delete"
                                  asp-controller="Post"
                                  asp-route-id="@post.Id"
                                  method="post">
                                <button type="submit" class="delete-link">
                                    <i class="bi bi-trash"></i> Delete
                                </button>
                            </form>
                        </div>
                    </div>
                </div>



                <img src="~/Images/Posts/@post.image"
                     class="post-image"
                     />

                <div class="post-actions">
                    <i class="bi bi-heart"></i>
                    <i class="bi bi-chat"></i>
                    <i class="bi bi-send"></i>
                    <i class="bi bi-bookmark ms-auto"></i>
                </div>

                <div class="post-body">

                    <div class="likes">
                        1,234 likes
                    </div>

                    <div class="caption">
                        <b>DevNet</b> @post.Content
                    </div>

                    <div class="comments">
                        View all comments
                    </div>

                    <div class="time">
                        @post.CreatedAt.ToString("dd MMM yyyy")
                    </div>


                </div>

            </div>
        }
    }
    else
    {
        <p>No posts yet.</p>
    }

</div>
<script>
        function toggleMenu(icon) {
        const menu = icon.nextElementSibling;

        document.querySelectorAll('.menu-content').forEach(m => {
            if (m !== menu) m.style.display = 'none';
        });

        menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
    }

    document.addEventListener('click', function(e) {
        if (!e.target.closest('.menu')) {
            document.querySelectorAll('.menu-content')
                .forEach(m => m.style.display = 'none');
        }
    });
</script>

